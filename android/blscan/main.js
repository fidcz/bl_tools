5sLyoqCiAqIOaLjeeFp+Wwj+elqOW5tk9DUgogKi8KCgoidWkiOwoKLy8g55m76K6waWQKLy8gdmFyIGRqSWQgPSAnMDAwJzsKdmFyIHN0b3JhZ2UgPSBzdG9yYWdlcy5jcmVhdGUoJ2NvbS5maWRjemJsLnNjYW4nKQp2YXIgZGpJZCA9IHN0b3JhZ2UuZ2V0KCdkamlkJywgJzAwMCcpOwovLyB1aS5kamlkLnNldFRleHQoJ0lEOiAnK2RqSWQpOwoKY29uc3QganNWZXIgPSBzdG9yYWdlLmdldCgndmVyJywgJzAnKTsKCmNvbnN0IHBob25lSCA9IGRldmljZS5oZWlnaHQ7IC8vIOmrmOW6pnB4CmNvbnN0IHBob25lVyA9IGRldmljZS53aWR0aDsgLy8g6K6+5aSH5a695bqmcHgKY29uc3QgY2FyZEggPSBNYXRoLmNlaWwocGhvbmVIIC8gMik7CmNvbnN0IGNhcmRZID0gTWF0aC5jZWlsKHBob25lSCAvIDIuMSk7CmNvbnN0IGNhcmRSYWRpdXMgPSBNYXRoLmNlaWwoZGV2aWNlLmhlaWdodCAvIDMyKTsKCmNvbnN0IHR5cGVDYXJkVyA9IE1hdGguY2VpbChwaG9uZVcgLyAzIC0gMzApCmNvbnN0IHR5cGVDYXJkVzIgPSBNYXRoLmNlaWwocGhvbmVXIC8gMyAtIDMwKSArIDE1CmNvbnN0IHR5cGVDYXJkVzMgPSBNYXRoLmNlaWwocGhvbmVXIC8gMyAtIDMwKSoyICsgMzAKCnZhciBGR0ggPSB7CiAgICAvL+mcgOimgeeUqOWIsOeahEFuZHJvaWTnsbvjgIIKICAgIENhbWVyYTogYW5kcm9pZC5oYXJkd2FyZS5DYW1lcmEsCiAgICBQYWNrYWdlTWFuYWdlcjogYW5kcm9pZC5jb250ZW50LnBtLlBhY2thZ2VNYW5hZ2VyLAogICAgU3VyZmFjZVZpZXc6IGFuZHJvaWQudmlldy5TdXJmYWNlVmlldywKICAgIFN1cmZhY2VIb2xkZXI6IGFuZHJvaWQudmlldy5TdXJmYWNlSG9sZGVyLAogICAgQml0bWFwOiBhbmRyb2lkLmdyYXBoaWNzLkJpdG1hcCwKICAgIEJpdG1hcEZhY3Rvcnk6IGFuZHJvaWQuZ3JhcGhpY3MuQml0bWFwRmFjdG9yeSwKICAgIE1hdHJpeDogYW5kcm9pZC5ncmFwaGljcy5NYXRyaXgsCiAgICBWaWV3OiBhbmRyb2lkLnZpZXcuVmlldywKICAgIEVudmlyb25tZW50OiBhbmRyb2lkLm9zLkVudmlyb25tZW50LAp9OwoKdWkubGF5b3V0KAogICAgPHZlcnRpY2FsPgogICAgICAgIDxmcmFtZT4KICAgICAgICAgICAgPGFuZHJvaWQudmlldy5TdXJmYWNlVmlldyBpZD0ic3VyZmFjZSIgdz0iKiIgaD0iKiIgLz4KICAgICAgICAgICAgPGltZyBpZD0iYm94IiBzcmM9Imh0dHBzOi8vZmlkY3ouY29kaW5nLm5ldC9wL2ZpZGN6X3ZlcnNpb24vZC9ibF90b29scy9naXQvcmF3L21hc3Rlci9hbmRyb2lkL2Jsc2Nhbi9ibG9jay5wbmciIHk9IjQwMHB4IiBsYXlvdXRfZ3Jhdml0eT0iY2VudGVyX2hvcml6b250YWwiIHc9Ijc1MHB4IiBoPSIxNTBweCIvPgogICAgICAgICAgICA8Y2FyZCB3PSIqIiBoPSJ7e2NhcmRIfX1weCIgbWFyZ2luQm90dG9tPSItMTUiIGxheW91dF9ncmF2aXR5PSJib3R0b20iIGNhcmRDb3JuZXJSYWRpdXM9Int7Y2FyZFJhZGl1c319cHgiIGNhcmRFbGV2YXRpb249IjgiIGNhcmRCYWNrZ3JvdW5kQ29sb3I9IiNmZmZmZmYiPgogICAgICAgICAgICAgICAgPHRleHQgaWQ9ImRqaWQiIHc9IjEwMCIgaD0iMTUiIG1hcmdpbj0iMTIgNSAwIDAiIGdyYXZpdHk9ImxlZnQiIHRleHQ9IklEOiB7e2RqSWR9fSIgLz4KICAgICAgICAgICAgICAgIDx0ZXh0IGlkPSJ2ZXJzaW9uIiB3PSI4MCIgaD0iMTUiIHRleHQ9InZlcjp7e2pzVmVyfX0iIG1hcmdpbj0iMCA1IDE2IDAiIGxheW91dF9ncmF2aXR5PSJyaWdodCIgZ3Jhdml0eT0icmlnaHQiIC8+CiAgICAgICAgICAgICAgICA8aW5wdXQgaWQ9Im9yZGVyaWQiIHc9IjI1MCIgaD0iNTAiIG1hcmdpbj0iOCAyMCAwIDAiIGhpbnQ9Iui/memHjOaYvuekuuiuouWNleWPtyIgc2luZ2xlTGluZT0idHJ1ZSIgLz4KICAgICAgICAgICAgICAgIDxidXR0b24gaWQ9InNlYXJjaCIgdz0iYXV0byIgaD0iNTAiIG1hcmdpbj0iOCAyMCAxMCAwIiBsYXlvdXRfZ3Jhdml0eT0icmlnaHQiIHRleHQ9IuafpeivoiIgcmFkaXVzPSIzMCIgc3R5bGU9IldpZGdldC5BcHBDb21wYXQuQnV0dG9uLkNvbG9yZWQiIC8+CiAgICAgICAgICAgICAgICA8ZnJhbWUgaWQ9ImRqZnJhbWUiIHZpc2liaWxpdHk9ImludmlzaWJsZSI+CiAgICAgICAgICAgICAgICAgICAgPGhvcml6b250YWwgbWFyZ2luVG9wPSI4MCIgdz0iKiIgaD0iMTUwIj4KICAgICAgICAgICAgICAgICAgICAgICAgPGxpc3Qgdz0iKiIgaWQ9ImRqTGlzdCI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8Y2FyZCB3PSIqIiBoPSIzMCIgbWFyZ2luQm90dG9tPSIxIj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGV4dCBtYXJnaW49IjEyIDUgMTAgNSIgcGFkZGluZz0iMCAwIDEwIDAiIHc9IioiIGg9IjIwIiB0ZXh0PSJ7e3RoaXMubGlzdG9yZGVyaWR9fSIgZ3Jhdml0eT0ibGVmdHxjZW50ZXIiIGVsbGlwc2l6ZT0iZW5kIiBzaW5nbGVMaW5lPSJ0cnVlIiAvPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ZXh0IG1hcmdpbj0iMTIgNSAxMCA1IiBzaXplPSIxMiIgdz0iMTIwIiBoPSIyMCIgbGF5b3V0X2dyYXZpdHk9InJpZ2h0IiBncmF2aXR5PSJsZWZ0fGNlbnRlciIgdGV4dD0ie3t0aGlzLmxpc3RzdGF0dXN9fSIgLz4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvY2FyZD4KICAgICAgICAgICAgICAgICAgICAgICAgPC9saXN0PgogICAgICAgICAgICAgICAgICAgIDwvaG9yaXpvbnRhbD4KICAgICAgICAgICAgICAgIDwvZnJhbWU+CiAgICAgICAgICAgICAgICA8ZnJhbWUgaWQ9ImN4ZnJhbWUiIHZpc2liaWxpdHk9ImludmlzaWJsZSI+CiAgICAgICAgICAgICAgICAgICAgPHRleHQgaWQ9ImNyZWF0ZXRpbWUiIHc9IjIyMCIgaD0iMjAiIHRleHQ9IuWIm+W7uuaXtumXtDoiIG1hcmdpbj0iMTIgNzUgMCAwIiBncmF2aXR5PSJsZWZ0IiAvPgogICAgICAgICAgICAgICAgICAgIDx0ZXh0IGlkPSJzaG9wbmFtZSIgdz0iMTMwIiBoPSIyMCIgdGV4dD0i5bqX6ZO6IiBtYXJnaW49IjUgNzUgMTUgMCIgbGF5b3V0X2dyYXZpdHk9InJpZ2h0IiBncmF2aXR5PSJyaWdodHxjZW50ZXIiIC8+CiAgICAgICAgICAgICAgICAgICAgPHRleHQgaWQ9InBheXRpbWUiIHc9IjIyMCIgaD0iMjAiIHRleHQ9IuS7mOasvuaXtumXtDoiIG1hcmdpbj0iMTIgOTggMCAwIiBncmF2aXR5PSJsZWZ0IiAvPgogICAgICAgICAgICAgICAgICAgIDx0ZXh0IGlkPSJvcmRlcnN0YXR1cyIgdz0iMTMwIiBoPSIyMCIgdGV4dD0i6K6i5Y2V54q25oCBIiBtYXJnaW49IjUgOTggMTUgMCIgbGF5b3V0X2dyYXZpdHk9InJpZ2h0IiBncmF2aXR5PSJyaWdodHxjZW50ZXIiIC8+CiAgICAgICAgICAgICAgICAgICAgPHRleHQgaWQ9ImtkIiB3PSIyMDAiIGg9IjIwIiB0ZXh0PSLlnIbpgJrlv6vpgJIgWVQzMTg5MzMxODY3Njg3IiBtYXJnaW49IjEyIDEyMSAxNSAwIiBsYXlvdXRfZ3Jhdml0eT0ibGVmdCIgZ3Jhdml0eT0ibGVmdHxjZW50ZXIiIC8+CiAgICAgICAgICAgICAgICAgICAgPHRleHQgaWQ9Inh0IiB3PSIxMDAiIGg9IjIwIiB0ZXh0PSLlt7LlvIDljZUiIG1hcmdpbj0iNSAxMjEgMTUgMCIgbGF5b3V0X2dyYXZpdHk9InJpZ2h0IiBncmF2aXR5PSJyaWdodHxjZW50ZXIiIC8+CiAgICAgICAgICAgICAgICAgICAgPGhvcml6b250YWwgbWFyZ2luVG9wPSIxNDAiIHc9IioiIGg9IjE1MCI+CiAgICAgICAgICAgICAgICAgICAgICAgIDxsaXN0IHc9IioiIGlkPSJteExpc3QiPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGNhcmQgdz0iKiIgaD0iNTAiIG1hcmdpbkJvdHRvbT0iMSI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRleHQgaWQ9Im14dGl0bGUiIG1hcmdpbj0iMTIgNSAxMCAwIiBwYWRkaW5nPSIwIDAgMTAgMCIgdz0iKiIgaD0iMjAiIHRleHQ9Int7dGhpcy50aXRsZX19IiBlbGxpcHNpemU9ImVuZCIgc2luZ2xlTGluZT0idHJ1ZSIgLz4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGV4dCBpZD0ibXhfbnVtaWQiIG1hcmdpbj0iMTIgMjYgMTAgMCIgc2l6ZT0iMTIiIHc9IjE1MCIgaD0iMjAiIGxheW91dF9ncmF2aXR5PSJsZWZ0IiBncmF2aXR5PSJsZWZ0fGNlbnRlciIgdGV4dD0ie3t0aGlzLm51bWlkfX0iIC8+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRleHQgaWQ9Im14X3BheSIgbWFyZ2luPSIxMiAyNiAxMCAwIiBzaXplPSIxMiIgdz0iMTAwIiBoPSIyMCIgbGF5b3V0X2dyYXZpdHk9InJpZ2h0IiBncmF2aXR5PSJyaWdodHxjZW50ZXIiIHRleHQ9IumHkeminTp7e3RoaXMucGF5fX0iIC8+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2NhcmQ+CiAgICAgICAgICAgICAgICAgICAgICAgIDwvbGlzdD4KICAgICAgICAgICAgICAgICAgICA8L2hvcml6b250YWw+CiAgICAgICAgICAgICAgICA8L2ZyYW1lPgogICAgICAgICAgICAgICAgPGJ1dHRvbiBpZD0ic2VuZF94dCIgdz0ie3t0eXBlQ2FyZFd9fXB4IiBoPSI2MCJ0ZXh0PSLplIDpgIAiIG1hcmdpbkJvdHRvbT0iNjUiIGxheW91dF9ncmF2aXR5PSJsZWZ0fGJvdHRvbSIgc3R5bGU9IldpZGdldC5BcHBDb21wYXQuQnV0dG9uLkJvcmRlcmxlc3MuQ29sb3JlZCIgLz4KICAgICAgICAgICAgICAgIDxidXR0b24gaWQ9InNlbmRfZGoiIHc9Int7dHlwZUNhcmRXfX1weCIgaD0iNjAidGV4dD0i55m76K6wIiBtYXJnaW5Cb3R0b209IjY1IiBsYXlvdXRfZ3Jhdml0eT0iY2VudGVyX2hvcml6b250YWx8Ym90dG9tIiBzdHlsZT0iV2lkZ2V0LkFwcENvbXBhdC5CdXR0b24uQm9yZGVybGVzcy5Db2xvcmVkIiAvPgogICAgICAgICAgICAgICAgPGJ1dHRvbiBpZD0ic2VuZF9jeCIgdz0ie3t0eXBlQ2FyZFd9fXB4IiBoPSI2MCJ0ZXh0PSLmn6Xor6IiIG1hcmdpbkJvdHRvbT0iNjUiIGxheW91dF9ncmF2aXR5PSJyaWdodHxib3R0b20iIHN0eWxlPSJXaWRnZXQuQXBwQ29tcGF0LkJ1dHRvbi5Cb3JkZXJsZXNzLkNvbG9yZWQiIC8+CiAgICAgICAgICAgICAgICA8YnV0dG9uIGlkPSJzdGFydEF1dG8iIHc9IioiIGg9IjYwInRleHQ9IuW8gOWni+ivhuWIqyIgbWFyZ2luQm90dG9tPSIxMCIgbGF5b3V0X2dyYXZpdHk9ImJvdHRvbXxjZW50ZXJfaG9yaXpvbnRhbCIgc3R5bGU9IldpZGdldC5BcHBDb21wYXQuQnV0dG9uLkNvbG9yZWQiIC8+CiAgICAgICAgICAgIDwvY2FyZD4KICAgICAgICA8L2ZyYW1lPgogICAgPC92ZXJ0aWNhbD4KKTsKCgokdWkuc3RhdHVzQmFyQ29sb3IoY29sb3JzLmFyZ2IoMjU1LCAyLCAxNzAsIDI0MykpOyAgLy/orr7nva7nirbmgIHmoI/popzoibIKCiR1aS5lbWl0dGVyLm9uKCJiYWNrX3ByZXNzZWQiLCAoKSA9PiB7CiAgICAvLyB0b2FzdCgn6L+U5Zue6ZSu6KKr5oyJ5LiLJyk7CiAgICByZWxlYXNlQWxsKCk7CiAgICBleGl0KCk7Cn0pOwoKLy8g5a6a5LmJ6buY6K6k5pGE5YOP5aS0CnZhciBjYW1lcmFQb3N0aW9uID0gMDsKdmFyIGN1cnJlbnRJbWcgPSBudWxsOwoKLy8g6Ieq5Yqo5oiq5Zu+57q/56iLCnZhciB0aHJlYWRBdXRvU2hvdCA9IG51bGw7CgovLyDkuIrmrKHoh6rliqhvY3LnmoTnu5PmnpwKdmFyIGxhc3RPY3JSZXN1bHQgPSBudWxsOwoKLy8g55m76K6w6K6w5b2VCnZhciBkalJlc3VsdCA9IFtdOwoKLy8gd2ViU29rY2V0CnZhciB3c09iaiA9IG51bGw7CnZhciB0aHJlYWRXcyA9IG51bGw7CgovLyB3c+acjeWKoeWZqApjb25zdCB3c1VybCA9ICJ3czovLzEuMTQuMjQ2LjkxOjUyMDYvYmxzY2FuIjsKCi8vIOW9k+WJjeeKtuaAgQp2YXIgc2VuZFR5cGUgPSAnY3gnOwoKCgovLyDlrprkvY3moYblnZDmoIcg5Y2V5L2NcHgKY29uc3QgdGl0bGVIZWlnaHQgPSA5NTsgLy8g54q25oCB5qCP6auY5bqmCnZhciBib3hYID0gLTE7CnZhciBib3hZID0gLTE7CnZhciBib3hXaWR0aCA9IE51bWJlcih1aS5ib3guYXR0cigndycpLnJlcGxhY2UoJ3B4JywgJycpKTsKdmFyIGJveEhlaWdodCA9IE51bWJlcih1aS5ib3guYXR0cignaCcpLnJlcGxhY2UoJ3B4JywgJycpKTsKLy8g6I635Y+W5qGG5qGG5a6a5L2NCi8vIFjlnZDmoIflsLHmmK/lsY/luZXlrr3luqYvMi3moYbmoYblrr3luqYvMgpib3hYID0gTWF0aC5yb3VuZChkZXZpY2Uud2lkdGgvMiAtIGJveFdpZHRoLzIpOwpib3hZID0gdWkuYm94LmdldFkoKSArIHRpdGxlSGVpZ2h0OwoKLy8g5qOA5rWL5pGE5YOP5aS0CmZ1bmN0aW9uIGNoZWNrQ2FtZXJhSGFyZHdhcmUoY29udGV4dCkgewogICAgaWYgKGNvbnRleHQuZ2V0UGFja2FnZU1hbmFnZXIoKS5oYXNTeXN0ZW1GZWF0dXJlKEZHSC5QYWNrYWdlTWFuYWdlci5GRUFUVVJFX0NBTUVSQSkpIHsKICAgICAgICAvLyB0aGlzIGRldmljZSBoYXMgYSBjYW1lcmEgCiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9IGVsc2UgewogICAgICAgIC8vIG5vIGNhbWVyYSBvbiB0aGlzIGRldmljZQogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KfQoKCgppZiAoIWNoZWNrQ2FtZXJhSGFyZHdhcmUoY29udGV4dCkpIHsKICAgIHRocm93ICLmsqHmnInmkYTlg4/lpLQiOwp9CgovLyB0b2FzdExvZygi5pGE5YOP5aS05pWw6YePOiAiICsgRkdILkNhbWVyYS5nZXROdW1iZXJPZkNhbWVyYXMoKSk7Cgp2YXIgbUNhbWVyYTsKdHJ5IHsKICAgIC8v5omT5byA56ysMeS4qijpu5jorqTnrKwx5LiqKeaRhOWDj+WktOOAggogICAgbUNhbWVyYSA9IEZHSC5DYW1lcmEub3BlbihjYW1lcmFQb3N0aW9uKTsKfSBjYXRjaCAoZSkgewogICAgdGhyb3cgZSArICIg5omT5byA5pGE5YOP5aS05aSx6LSl77yM5Y+v6IO95rKh5pyJ5p2D6ZmQ6K+35omL5Yqo5Yiw5bqU55So5p2D6ZmQ6YeM6Z2i5omT5byAIjsKfQoKLy8g5re75Yqg6ZSZ6K+v55qE5Zue6LCD44CCCm1DYW1lcmEuc2V0RXJyb3JDYWxsYmFjayhmdW5jdGlvbihtQ2FtZXJhKSB7CiAgICB0b2FzdCgi5Ye66ZSZ5LqGLOW7uuiuruWFs+mXrei9r+S7tuWQjuWPsOmHjeaWsOaJk+W8gCIpOwp9KTsKCi8v6aKE6KeI6L+H56iL5Lit55qE5Zue6LCD44CCCi8vIG1DYW1lcmEuc2V0T25lU2hvdFByZXZpZXdDYWxsYmFjayhuZXcgRkdILkNhbWVyYS5QcmV2aWV3Q2FsbGJhY2soewovLyAgICAgb25QcmV2aWV3RnJhbWU6IGZ1bmN0aW9uKGRhdGEsIGNhbWVyYSkgewovLyAgICAgICAgIC8vZGF0YeS4umJ5dGVz5pWw5o2uOwovLyAgICAgICAgIC8v6L+Z6YeM5Y+v5Lul5YGa5LiA5Lqb5LqM57u056CB6K+G5Yir55qE5Yqf6IO944CCCi8vICAgICAgICAgLy8gbGV0IGJpdG1hcD1GR0guQml0bWFwRmFjdG9yeS5kZWNvZGVCeXRlQXJyYXkoZGF0YSwgMCwgZGF0YS5sZW5ndGgpOwovLyAgICAgICAgIGlmKGRhdGEgIT0gbnVsbCl7Ci8vICAgICAgICAgICAgIHRvYXN0TG9nKCdQcmV2aWV3IScpOwovLyAgICAgICAgIH0KCgovLyAgICAgfSwKLy8gfSkpOwoKLy8gLy8g5paw6aKE6KeI5Zue6LCDCi8vIG1DYW1lcmEuc2V0UHJldmlld0NhbGxiYWNrV2l0aEJ1ZmZlcihuZXcgRkdILkNhbWVyYS5QcmV2aWV3Q2FsbGJhY2soewovLyAgICAgb25QcmV2aWV3RnJhbWU6IChkYXRhLCBjYW1lcmEpPT57Ci8vICAgICAgICAgLy8g5LiA55u05Lya5Zue6LCDCi8vICAgICAgICAgdG9hc3QoZGF0YSk7Ci8vICAgICB9Ci8vIH0pKQoKdmFyIHN1cmZhY2UgPSB1aS5zdXJmYWNlOwoKdmFyIGhvbGRlciA9IHN1cmZhY2UuZ2V0SG9sZGVyKCk7CgovL+a3u+WKoOaOp+S7tueahOWbnuiwg+S6i+S7tuOAguWbnuiwg+eahOaEj+aAneaYr+OAguW9k+S7gOS5iOS7gOS5iOaDheWGteS4i++8jOaAjuS5iOaAjuS5iOWBmu+8nwpob2xkZXIuYWRkQ2FsbGJhY2sobmV3IEZHSC5TdXJmYWNlSG9sZGVyLkNhbGxiYWNrKHsKICAgIHN1cmZhY2VDcmVhdGVkOiBmdW5jdGlvbihob2xkZXIpIHsKICAgICAgICAvL1N1cmZhY2VWaWV3JlN1cmZhY2VIb2xkZXLnmoTliJvlu7rlrozmiJDlm57osIMKICAgICAgICB0cnkgewogICAgICAgICAgICBtQ2FtZXJhLnNldFByZXZpZXdEaXNwbGF5KGhvbGRlcik7CiAgICAgICAgICAgIG1DYW1lcmEuc2V0RGlzcGxheU9yaWVudGF0aW9uKDkwKTsKICAgICAgICAgICAgbUNhbWVyYS5zdGFydFByZXZpZXcoKTsKICAgICAgICAgICAgLyoKICAgICAgICAgICAgaWYgKGZvY3VzTW9kZXMuY29udGFpbnMoRkdILkNhbWVyYS5QYXJhbWV0ZXJzLkZPQ1VTX01PREVfQVVUTykpIHsKICAgICAgICAgICAgICAgIC8vIEF1dG9mb2N1cyBtb2RlIGlzIHN1cHBvcnRlZCAKICAgICAgICAgICAgICAgIHRvYXN0TG9nKCLmlK/mjIHoh6rliqjlr7nnhKYiKTsKICAgICAgICAgICAgICAgIC8vIHNldCB0aGUgZm9jdXMgbW9kZQogICAgICAgICAgICAgICAgcGFyYW1zLnNldEZvY3VzTW9kZShGR0guQ2FtZXJhLlBhcmFtZXRlcnMuRk9DVVNfTU9ERV9BVVRPKTsKICAgICAgICAgICAgICAgIC8vIHNldCBDYW1lcmEgcGFyYW1ldGVycwogICAgICAgICAgICAgICAgbUNhbWVyYS5zZXRQYXJhbWV0ZXJzKHBhcmFtcyk7CiAgICAgICAgICAgIH07CiAgICAgICAgICAgICovCiAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgICB0aHJvdyBlOwogICAgICAgIH0KICAgIH0sCiAgICBzdXJmYWNlQ2hhbmdlZDogZnVuY3Rpb24oaG9sZGVyLCBmb3JtYXQsIHdpZHRoLCBoZWlnaHQpIHsKICAgICAgICAvLyDlpoLmnpzlhYHorrjpooTop4jlj6/ku6Xmm7TmlLnmiJbml4vovazvvIzlj6/ku6XlnKjov5nph4zlpITnkIbov5nkupvkuovku7YKICAgICAgICBtQ2FtZXJhLnN0b3BQcmV2aWV3KCk7CiAgICAgICAgdGhpcy5zdXJmYWNlQ3JlYXRlZChob2xkZXIpOwogICAgfSwKICAgIHN1cmZhY2VEZXN0cm95ZWQ6IGZ1bmN0aW9uKGhvbGRlcikgewogICAgICAgIC8v57uT5p2f44CCLy/liIfmjaLliLDlhbbku5bova/ku7bpobXpnaLkuZ/kvJrov5DooYzmraTlm57osIPjgIIKICAgIH0sCn0pKTsKCgp1aS5zdXJmYWNlLnNldE9uQ2xpY2tMaXN0ZW5lcihuZXcgRkdILlZpZXcuT25DbGlja0xpc3RlbmVyKHsKICAgIG9uQ2xpY2s6IGZ1bmN0aW9uKHZpZXcpIHsKICAgICAgICB0cnkgewogICAgICAgICAgICAvL+iHquWKqOiBmueEpuOAggogICAgICAgICAgICBtQ2FtZXJhLmF1dG9Gb2N1cyhuZXcgRkdILkNhbWVyYS5BdXRvRm9jdXNDYWxsYmFjayh7CiAgICAgICAgICAgICAgICBvbkF1dG9Gb2N1czogZnVuY3Rpb24oc3VjY2VzcywgY2FtZXJhKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKHN1Y2Nlc3MpIHsKICAgICAgICAgICAgICAgICAgICAgICAgLy8gdG9hc3RMb2coIuiBmueEpuaIkOWKnyIpOwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRvYXN0TG9nKCLogZrnhKblpLHotKUiKTsKCiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSkpOwogICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgICAgdG9hc3RMb2coZSk7CiAgICAgICAgfTsKICAgIH0sCn0pKTsKCi8vIOmAgOWHuuaXtumHiuaUvui1hOa6kApldmVudHMub24oImV4aXQiLCBmdW5jdGlvbigpIHsKICAgIHJlbGVhc2VBbGwoKTsKICAgIGV4aXQoKTsKfSk7CgpmdW5jdGlvbiByZWxlYXNlQWxsKCl7CiAgICAvLyDph4rmlL7miKrlm77otYTmupAKICAgIGlmKGN1cnJlbnRJbWcgIT0gbnVsbCl7CiAgICAgICAgY3VycmVudEltZy5yZWN5Y2xlKCk7CiAgICB9CiAgICAvLyDph4rmlL53c+i1hOa6kAogICAgdHJ5ewogICAgICAgIGlmKHdzT2JqICE9IG51bGwpewogICAgICAgICAgICB3c09iai5jYW5jZWwoKTsKICAgICAgICAgICAgd3NPYmouY2xvc2UoMTAwMSk7CiAgICAgICAgfQogICAgfWNhdGNoKGVycm9yKXsKICAgICAgICBsb2coZXJyb3IpOwogICAgfQoKICAgIC8v6YeK5pS+5pGE5YOP5aS06LWE5rqQ44CCCiAgICAvL+aRhOWDj+WktOaYr+aJi+acuuaJgOacieW6lOeUqOeoi+W6j+eahOWFseeUqOiuvuWkh+OAggogICAgLy/pnIDopoHlm57mlLbku6Xkvr/lhbbku5bova/ku7bkvb/nlKjjgIIKICAgIG1DYW1lcmEuc3RvcFByZXZpZXcoKTsKICAgIG1DYW1lcmEucmVsZWFzZSgpOwogICAgY29uc29sZS5oaWRlKCk7CiAgICAkaW1hZ2VzLnN0b3BTY3JlZW5DYXB0dXJlKCk7Cn0KCi8v54K55Ye76K+G5Yir5oyJ6ZKuCnVpLnN0YXJ0QXV0by5zZXRPbkNsaWNrTGlzdGVuZXIobmV3IEZHSC5WaWV3Lk9uQ2xpY2tMaXN0ZW5lcih7CiAgICBvbkNsaWNrOiBmdW5jdGlvbih2aWV3KSB7CiAgICAgICAgdHJ5ewogICAgICAgICAgICAvLyB0b2FzdExvZygn5byA5aeL6K+G5YirJyk7CgogICAgICAgICAgICAvLyB0b2FzdExvZyhib3hYICsgJywnICsgYm94WSArICcsJyArIGJveFdpZHRoICsgJywnICsgYm94SGVpZ2h0KTsKICAgICAgICAgICAgLy8gdmFyIGltZyA9IGNhcHR1cmVTY3JlZW4oKTsKICAgICAgICAgICAgLy8gdmFyIGltZzIgPSBpbWFnZXMuY2xpcChpbWcsIGJveFgsIGJveFksIGJveFdpZHRoLCBib3hIZWlnaHQpOwogICAgICAgICAgICAvLyB0b2FzdExvZyhnZXRPY3JSZXN1bHQoaW1nMikpOwogICAgICAgICAgICBpZih2aWV3LmdldFRleHQoKSA9PSAn5byA5aeL6K+G5YirJyl7CiAgICAgICAgICAgICAgICB1aS5zdGFydEF1dG8uc2V0VGV4dCgn5pqC5YGc6K+G5YirJyk7CiAgICAgICAgICAgICAgICB0aHJlYWRBdXRvU2hvdCA9IHRocmVhZHMuc3RhcnQoc2hvdFhpYW9QaWFvKTsKICAgICAgICAgICAgICAgIC8vIGNyZWF0ZVdlYlNvY2tldCgpOwogICAgICAgICAgICB9ZWxzZSBpZih2aWV3LmdldFRleHQoKSA9PSAn5pqC5YGc6K+G5YirJyl7CiAgICAgICAgICAgICAgICB1aS5zdGFydEF1dG8uc2V0VGV4dCgn5byA5aeL6K+G5YirJyk7CiAgICAgICAgICAgICAgICBkZXZpY2UuY2FuY2VsS2VlcGluZ0F3YWtlKCk7CiAgICAgICAgICAgICAgICBpZih0aHJlYWRBdXRvU2hvdCAhPSBudWxsKXsKICAgICAgICAgICAgICAgICAgICAvLyDlt7LlkK/liqjvvIznu4jmraLov5DooYwKICAgICAgICAgICAgICAgICAgICBpZih0aHJlYWRBdXRvU2hvdC5pc0FsaXZlKCkpewogICAgICAgICAgICAgICAgICAgICAgICB0cnl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJlYWRBdXRvU2hvdC5pbnRlcnJ1cHQoKTsKICAgICAgICAgICAgICAgICAgICAgICAgfWNhdGNoKGVycm9yMSl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJlYWRBdXRvU2hvdCA9IG51bGwoKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB0aHJlYWRBdXRvU2hvdCA9IG51bGwoKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgdGhyZWFkQXV0b1Nob3QgPSBudWxsOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIAogICAgICAgIH1jYXRjaChlcnJvcil7CiAgICAgICAgICAgIGxvZyhlcnJvci5tZXNzYWdlKTsKICAgICAgICB9CiAgICB9LAp9KSk7CgpmdW5jdGlvbiBnZXRSZXF1ZXN0c1NjcmVlbigpewogICAgLy8g55Sz6K+35ouN54WnCiAgICBpZigkaW1hZ2VzLmdldFNjcmVlbkNhcHR1cmVPcHRpb25zKCkgPT0gbnVsbCl7CiAgICAgICAgLy8g6K+35rGC5oiq5Zu+CiAgICAgICAgaWYoIXJlcXVlc3RTY3JlZW5DYXB0dXJlKCkpewogICAgICAgICAgICB0b2FzdCgi6K+35rGC5oiq5Zu+5aSx6LSlIik7CiAgICAgICAgICAgIHJlbGVhc2VBbGwoKTsKICAgICAgICAgICAgZXhpdCgpOwogICAgICAgIH0KICAgIH0KfQovLyDnur/nqIvnlLPor7fmi43nhacKdGhyZWFkcy5zdGFydChnZXRSZXF1ZXN0c1NjcmVlbik7CgpmdW5jdGlvbiBnZXRPY3JSZXN1bHQoaW1nKXsKICAgIHRyeXsKICAgICAgICB2YXIgb2NyUmVzdWx0cyA9IG51bGw7CiAgICAgICAgdWkucnVuKCgpID0+IHsKICAgICAgICAgICAgLy8g5Lyg5YWl5Zu+54mH77yM6L+U5ZueT0NS5ZCO55qE57uT5p6cCiAgICAgICAgICAgIHZhciBvY3IgPSAkcGx1Z2lucy5sb2FkKCJjb20uaHJhcHMub2NyIik7CiAgICAgICAgICAgIC8vIOeBsOW6puWMluWbvueJhwogICAgICAgICAgICB2YXIgZyA9IGltYWdlcy5ncmF5c2NhbGUoaW1nKTsKICAgICAgICAgICAgdmFyIHJlc3VsdCA9IGltYWdlcy5hZGFwdGl2ZVRocmVzaG9sZChnLCAyMDAsICJNRUFOX0MiLCAiQklOQVJZIiwgMjUsIDEwKTsKICAgICAgICAgICAgZy5yZWN5Y2xlKCk7CiAgICAgICAgICAgIG9jclJlc3VsdHMgPSBvY3IuZGV0ZWN0KHJlc3VsdC5nZXRCaXRtYXAoKSwxKTsKICAgICAgICAgICAgCiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuIG9jclJlc3VsdHMuZ2V0KDApLnRleHQ7CgogICAgfWNhdGNoKGVycm9yKXsKICAgICAgICAvLyBzZXRDbGlwKGVycm9yLm1lc3NhZ2UpOwogICAgICAgIC8vIHRvYXN0TG9nKGVycm9yLm1lc3NhZ2UpOwogICAgICAgIC8vIHNldENsaXAoJGRlYnVnLmdldFN0YWNrVHJhY2UoZXJyb3IpKTsKICAgICAgICAvLyB0b2FzdExvZygkZGVidWcuZ2V0U3RhY2tUcmFjZShlcnJvcikpOwogICAgICAgIHJldHVybiAnZXJyb3InOwogICAgfQoKfQoKZnVuY3Rpb24gc2hvdFhpYW9QaWFvKCl7CiAgICAvLyDnur/nqIvlkK/liqjoh6rliqjmiKrlm77lsI/npagKICAgIGRldmljZS5rZWVwU2NyZWVuT24oMzYwMCAqIDEwMDApOwoKLy/lj6/ku6Xkvb/nlKhkZXZpY2UuY2FuY2VsS2VlcGluZ0F3YWtlKCkKICAgIHdoaWxlKDEpewogICAgICAgIHRyeXsKICAgICAgICAgICAgdmFyIGltZyA9IGNhcHR1cmVTY3JlZW4oKTsKICAgICAgICAgICAgdmFyIGltZzIgPSBpbWFnZXMuY2xpcChpbWcsIGJveFgsIGJveFksIGJveFdpZHRoLCBib3hIZWlnaHQpOwogICAgICAgICAgICB2YXIgb2NyUmVzdWx0ID0gZ2V0T2NyUmVzdWx0KGltZzIpOwogICAgICAgICAgICBpZihjaGVja09jclJlc3VsdChvY3JSZXN1bHQpKXsKICAgICAgICAgICAgICAgIHVpLnJ1bigoKT0+ewogICAgICAgICAgICAgICAgICAgIHVpLm9yZGVyaWQuc2V0VGV4dChvY3JSZXN1bHQucmVwbGFjZSgvKF5ccyopfChccyokKS9nLCIiKSk7CiAgICAgICAgICAgICAgICAgICAgdWkub3JkZXJpZC5zZXRFcnJvcihudWxsKTsKICAgICAgICAgICAgICAgICAgICB1aS5zZWFyY2guY2xpY2soKTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgIH0KICAgICAgICB9Y2F0Y2goZXJyb3IpewogICAgICAgICAgICBzbGVlcCgzMDAwKTsKICAgICAgICB9CiAgICAgICAgc2xlZXAoODUwKTsKICAgIH0KfQoKZnVuY3Rpb24gY2hlY2tPY3JSZXN1bHQocmVzdWx0KXsKICAgIC8vIOajgOafpU9DUueahOe7k+aenOaYr+WQpuS4uuiuouWNleWPt++8jOWmguaenOS4jeaYr+WImeS4jeaPkOmGkgogICAgaWYocmVzdWx0Lmxlbmd0aCA8PSAwKXsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgICB2YXIgcmVSdWxlID0gL14oW2EtekEtWl17Miw0fSk/XGR7Nn0tP1xkezQsMTZ9JC87CiAgICBpZihyZVJ1bGUudGVzdChyZXN1bHQpKXsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH1lbHNlewogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KfQoKZnVuY3Rpb24gY3JlYXRlV2ViU29ja2V0KCl7CiAgICAvLyDliJvlu7p3c+e6v+eoiwogICAgaWYod3NPYmogIT0gbnVsbCl7CiAgICAgICAgdHJ5ewogICAgICAgICAgICB3c09iai5jYW5jZWwoKTsKICAgICAgICAgICAgd3NPYmouY2xvc2UoMTAwMCk7CiAgICAgICAgfWNhdGNoKGVycm9yKXsKICAgICAgICAgICAgbG9nKGVycm9yKTsKICAgICAgICB9CiAgICB9CgogICAgd3NPYmogPSAkd2ViLm5ld1dlYlNvY2tldCh3c1VybCwgewogICAgICAgIGV2ZW50VGhyZWFkOiAndGhpcycKICAgIH0pOwoKICAgIHdzT2JqLm9uKCJvcGVuIiwgKHJlcywgd3MpID0+IHsKICAgICAgICBsb2coIldlYlNvY2tldOW3suaJk+W8gCIpOwogICAgICAgIHdzLnNlbmQoSlNPTi5zdHJpbmdpZnkoeyd0JzogJ3BnJ30pKTsKCiAgICB9KS5vbigiZmFpbHVyZSIsIChlcnIsIHJlcywgd3MpID0+IHsKICAgICAgICB0b2FzdExvZygi572R57uc6L+e5o6l5aSx6LSlIik7CiAgICAgICAgd3NPYmogPSBudWxsOwogICAgfSkub24oImNsb3NpbmciLCAoY29kZSwgcmVhc29uLCB3cykgPT4gewogICAgICAgIC8vIHRvYXN0TG9nKCJXZWJTb2NrZXTlhbPpl63kuK0iKTsKICAgICAgICB3c09iaiA9IG51bGw7CiAgICB9KS5vbigiY2xvc2VkIiwgKGNvZGUsIHJlYXNvbiwgd3MpID0+IHsKICAgICAgICAvLyB0b2FzdExvZygiV2ViU29ja2V05bey5YWz6ZetOiBjb2RlID0gJWQsIHJlYXNvbiA9ICVzIiwgY29kZSwgcmVhc29uKTsKICAgICAgICB3c09iaiA9IG51bGw7CiAgICB9KTsKCiAgICB3c09iai5vbigidGV4dCIsICh0ZXh0LCB3cyk9PnsKICAgICAgICAvLyB0b2FzdExvZyh0ZXh0KTsKICAgICAgICAvLyDov5nph4zliqDlhaXlpITnkIbku6PnoIEKICAgICAgICBnZXREYXRhID0gSlNPTi5wYXJzZSh0ZXh0KTsKICAgICAgICBpZihnZXREYXRhLm1zZyA9PSAn6K6i5Y2V5Y+35bey5a2Y5ZyoJyB8fCBnZXREYXRhLm1zZyA9PSAn5bey5aSN5Yi25Yiw55S16ISRJyl7CiAgICAgICAgICAgIHNob3dEalJlc3VsdCh7J2xpc3RvcmRlcmlkJzogdWkub3JkZXJpZC5nZXRUZXh0KCksICdsaXN0c3RhdHVzJzogZ2V0RGF0YS5tc2d9KTsKICAgICAgICB9CiAgICAgICAgaWYoZ2V0RGF0YS5zdGF0dXMgIT0gJ3N1Y2Nlc3MnKXsKICAgICAgICAgICAgLy8g5aSx6LSlCiAgICAgICAgICAgIHVpLnJ1bigoKT0+ewogICAgICAgICAgICAgICAgdWkub3JkZXJpZC5zZXRFcnJvcihnZXREYXRhLm1zZyk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIGlmKGdldERhdGEudCA9PSAnZGonIHx8IGdldERhdGEudCA9PSAneHQnKXsKICAgICAgICAgICAgLy8g55m76K6w57uT5p6cCiAgICAgICAgICAgIHRvYXN0KGdldERhdGEubXNnKTsKICAgICAgICAgICAgCiAgICAgICAgfWVsc2UgaWYoZ2V0RGF0YS50ID09ICdjeCcpewogICAgICAgICAgICAvLyDmn6Xor6Lnu5PmnpwKICAgICAgICAgICAgaWYoZ2V0RGF0YS5yID09ICcnKXsKICAgICAgICAgICAgICAgIHVpLnJ1bigoKT0+ewogICAgICAgICAgICAgICAgICAgIC8vIOafpeivouS4jeWIsOiuouWNleWPtwogICAgICAgICAgICAgICAgICAgIHVpLm9yZGVyaWQuc2V0RXJyb3IoZ2V0RGF0YS5tc2cpOwogICAgICAgICAgICAgICAgICAgIC8vIHRvYXN0KGdldERhdGEubXNnKTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9ZWxzZXsKICAgICAgICAgICAgICAgIGlmKHR5cGVvZihnZXREYXRhLnIpID09ICdzdHJpbmcnKXsKICAgICAgICAgICAgICAgICAgICAvLyDnu5PmnpzmmK/ku4XmloflrZcs5LuF6K6+572u6K6i5Y2V5Y+3CiAgICAgICAgICAgICAgICAgICAgdWkucnVuKCgpPT57CiAgICAgICAgICAgICAgICAgICAgICAgIHVpLm9yZGVyaWQuc2V0VGV4dChnZXREYXRhLnIpOwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfWVsc2V7CiAgICAgICAgICAgICAgICAgICAgLy8g6K6+572u5bmz5Y+w5ZKM54q25oCBCiAgICAgICAgICAgICAgICAgICAgdWkucnVuKCgpPT57CiAgICAgICAgICAgICAgICAgICAgICAgIHVpLm9yZGVyaWQuc2V0VGV4dChnZXREYXRhLnIuaWQpOwogICAgICAgICAgICAgICAgICAgICAgICBzaG93Q3hSZXN1bHQoZ2V0RGF0YS5yKTsKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0pOwp9CgpjcmVhdGVXZWJTb2NrZXQoKTsKCnVpLnNlYXJjaC5vbignY2xpY2snLCAoKT0+ewogICAgdHJ5ewogICAgICAgIGlmKHdzT2JqID09IG51bGwpewogICAgICAgICAgICBjcmVhdGVXZWJTb2NrZXQoKTsKICAgICAgICB9CiAgICAgICAgaWYoIXdzT2JqLnNlbmQoSlNPTi5zdHJpbmdpZnkoeyd0JzogJ3BnJ30pKSl7CiAgICAgICAgICAgIGNyZWF0ZVdlYlNvY2tldCgpOwogICAgICAgIH0KICAgIH1jYXRjaChlcnJvcil7CiAgICAgICAgY3JlYXRlV2ViU29ja2V0KCk7CiAgICB9CgoKICAgIGxldCBvcmRlcklkID0gU3RyaW5nKHVpLm9yZGVyaWQuZ2V0VGV4dCgpKS5yZXBsYWNlKC8oXlxzKil8KFxzKiQpL2csIiIpOwogICAgaWYoY2hlY2tPY3JSZXN1bHQob3JkZXJJZCkpewogICAgICAgIGlmKHNlbmRUeXBlID09ICcnKXsKICAgICAgICAgICAgc2VuZFR5cGUgPSAnY3gnOwogICAgICAgIH0KCiAgICAgICAgLy8g5qOA5rWL5piv5ZCm6YeN5aSN5Y+R6YCBCiAgICAgICAgaWYobGFzdE9jclJlc3VsdCA9PSBudWxsIHx8IGxhc3RPY3JSZXN1bHQgPT09IHVuZGVmaW5lZCl7CiAgICAgICAgICAgIGxhc3RPY3JSZXN1bHQgPSB7J2lkJzogb3JkZXJJZCwgJ3R5cGUnOiBzZW5kVHlwZX07CiAgICAgICAgfWVsc2V7CiAgICAgICAgICAgIGlmKGxhc3RPY3JSZXN1bHQuaWQgPT09IG9yZGVySWQgJiYgbGFzdE9jclJlc3VsdC50eXBlID09PSBzZW5kVHlwZSl7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH1lbHNlewogICAgICAgICAgICAgICAgbGFzdE9jclJlc3VsdCA9IHsnaWQnOiBvcmRlcklkLCAndHlwZSc6IHNlbmRUeXBlfTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpZighd3NPYmouc2VuZChKU09OLnN0cmluZ2lmeSh7J3QnOiBzZW5kVHlwZSwgJ2lkJzogZGpJZCwgJ2MnOiBvcmRlcklkfSkpKXsKICAgICAgICAgICAgdG9hc3RMb2coJ+WPkemAgeWksei0pScpOwogICAgICAgIH0KICAgIH0KfSk7Cgp1aS5zZW5kX3h0Lm9uKCdjbGljaycsICgpPT57CiAgICBzZW5kVHlwZSA9ICd4dCc7CiAgICB2aXNPYmoudmlzQ3hGcmFtZSgpOwogICAgdmlzT2JqLnZpc0RqRnJhbWUoKTsKICAgIHVpLnNlbmRfeHQuc2V0VGV4dCgnKumUgOmAgCcpOwogICAgdWkuc2VuZF9kai5zZXRUZXh0KCfnmbvorrAnKTsKICAgIHVpLnNlbmRfY3guc2V0VGV4dCgn5p+l6K+iJyk7CiAgICB1aS5zZWFyY2guc2V0VGV4dCgn6ZSA6YCAJyk7Cn0pOwoKdWkuc2VuZF9kai5vbignY2xpY2snLCAoKT0+ewogICAgc2VuZFR5cGUgPSAnZGonOwogICAgdmlzT2JqLnZpc0N4RnJhbWUoKTsKICAgIHVpLnNlbmRfeHQuc2V0VGV4dCgn6ZSA6YCAJyk7CiAgICB1aS5zZW5kX2RqLnNldFRleHQoJyrnmbvorrAnKTsKICAgIHVpLnNlbmRfY3guc2V0VGV4dCgn5p+l6K+iJyk7CiAgICB1aS5zZWFyY2guc2V0VGV4dCgn55m76K6wJyk7Cn0pOwoKdWkuc2VuZF9kai5sb25nQ2xpY2soKCk9PnsKICAgIC8vIOmVv+aMieiuvue9rmlkCiAgICBsZXQgc2V0SWQgPSB1aS5vcmRlcmlkLnRleHQoKS5yZXBsYWNlKC8oXlxzKil8KFxzKiQpL2csIiIpOwogICAgaWYoaXNOYU4oTnVtYmVyKHNldElkKSkgfHwgc2V0SWQubGVuZ3RoICE9IDMpewogICAgICAgIHRvYXN0KCdpZOagvOW8j+mUmeivryzor7fovpPlhaUz5L2N5pWw5a2XJyk7CiAgICAgICAgcmV0dXJuOwogICAgfQogICAgc3RvcmFnZS5wdXQoJ2RqaWQnLCBzZXRJZCk7CiAgICBkaklkID0gc2V0SWQ7CiAgICB1aS5kamlkLnNldFRleHQoJ0lEOiAnICsgc2V0SWQpOwogICAgdG9hc3QoJ+iuvue9rmlk5oiQ5YqfJyk7Cn0pOwoKdWkuc2VuZF9jeC5vbignY2xpY2snLCAoKT0+ewogICAgc2VuZFR5cGUgPSAnY3gnOwogICAgdmlzT2JqLnZpc0RqRnJhbWUoKTsKICAgIHVpLnNlbmRfeHQuc2V0VGV4dCgn6ZSA6YCAJyk7CiAgICB1aS5zZW5kX2RqLnNldFRleHQoJ+eZu+iusCcpOwogICAgdWkuc2VuZF9jeC5zZXRUZXh0KCcq5p+l6K+iJyk7CiAgICB1aS5zZWFyY2guc2V0VGV4dCgn5p+l6K+iJyk7Cn0pOwoKZnVuY3Rpb24gc2hvd0RqUmVzdWx0KGRqVG1wUmVzdWx0KXsKICAgIC8vIOaYvuekuueZu+iusOaOp+S7tgogICAgaWYoZGpUbXBSZXN1bHQgPT0gbnVsbCB8fCBkalRtcFJlc3VsdCA9PSB1bmRlZmluZWQpIHJldHVybjsKICAgIHVpLnBvc3QoKCk9PnsKICAgICAgICB1aS5kamZyYW1lLmF0dHIoInZpc2liaWxpdHkiLCAidmlzaWJsZSIpOyAvLyDmmL7npLoKICAgICAgICAKICAgICAgICBpZihkalJlc3VsdC5sZW5ndGggPj0gNSkgZGpSZXN1bHQucG9wKCk7CgogICAgICAgIGRqUmVzdWx0LnNwbGljZSgwLCAwLCBkalRtcFJlc3VsdCk7CgogICAgICAgIGxvZyhkalJlc3VsdCk7CgogICAgICAgIHVpLmRqTGlzdC5zZXREYXRhU291cmNlKGRqUmVzdWx0KTsKICAgIH0pOwp9CgpmdW5jdGlvbiBzaG93Q3hSZXN1bHQoY3hyZXN1bHQpewogICAgLy8g5pi+56S65p+l6K+i5o6n5Lu2CiAgICBpZihjeHJlc3VsdCA9PSBudWxsKSByZXR1cm47CiAgICB1aS5ydW4oKCk9PnsKICAgICAgICB1aS5jeGZyYW1lLmF0dHIoInZpc2liaWxpdHkiLCAidmlzaWJsZSIpOyAvLyDmmL7npLoKICAgICAgICAKICAgICAgICAvLyDliJvlu7rml7bpl7QKICAgICAgICB1aS5jcmVhdGV0aW1lLnNldFRleHQoJ+WIm+W7uuaXtumXtDonK2N4cmVzdWx0LmNyZWF0ZXRpbWUpOwogICAgICAgIC8vIOS7mOasvuaXtumXtAogICAgICAgIHVpLnBheXRpbWUuc2V0VGV4dCgn5LuY5qy+5pe26Ze0OicrY3hyZXN1bHQucGF5dGltZSk7CiAgICAgICAgLy8g5b+r6YCSCiAgICAgICAgdWkua2Quc2V0VGV4dChjeHJlc3VsdC5rZCk7CiAgICAgICAgLy8g5bqX6ZO6CiAgICAgICAgdWkuc2hvcG5hbWUuc2V0VGV4dChjeHJlc3VsdC5wdCk7CiAgICAgICAgLy8g6K6i5Y2V54q25oCBCiAgICAgICAgdWkub3JkZXJzdGF0dXMuc2V0VGV4dChjeHJlc3VsdC5zdGF0dXMpOwogICAgICAgIC8vIOaYr+WQpuW8gOWNlemUgOmAgAogICAgICAgIHVpLnh0LnNldFRleHQoY3hyZXN1bHQueHQpOwoKICAgICAgICAvLyDllYblk4HmmI7nu4YKICAgICAgICB1aS5teExpc3Quc2V0RGF0YVNvdXJjZShjeHJlc3VsdC5teCk7CiAgICB9KTsKfQoKCnZhciB2aXNPYmogPSB7CiAgICB2aXNDeEZyYW1lOiAoKT0+ewogICAgICAgIC8vIOmakOiXj+afpeivoue7k+aenAogICAgICAgIHVpLnJ1bigoKT0+ewogICAgICAgICAgICB1aS5jeGZyYW1lLmF0dHIoInZpc2liaWxpdHkiLCAiaW52aXNpYmxlIik7IC8vIOmakOiXjwogICAgICAgIH0pOwogICAgfSwKICAgIHZpc0RqRnJhbWU6ICgpPT57CiAgICAgICAgLy8g6ZqQ6JeP55m76K6w57uT5p6cCiAgICAgICAgdWkucnVuKCgpPT57CiAgICAgICAgICAgIHVpLmRqZnJhbWUuYXR0cigidmlzaWJpbGl0eSIsICJpbnZpc2libGUiKTsgLy8g6ZqQ6JePCiAgICAgICAgfSk7CiAgICB9Cn+00=